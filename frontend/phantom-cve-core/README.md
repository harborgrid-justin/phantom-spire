# phantom-cve-core

A high-performance CVE processing core with advanced threat intelligence capabilities, built with Rust and N-API for optimal Node.js integration.

## Features

- üöÄ **High Performance**: Native Rust implementation with N-API bindings
- üõ°Ô∏è **Advanced Threat Intelligence**: Comprehensive vulnerability analysis and correlation
- üîç **Intelligent Search**: Advanced CVE search with multiple criteria
- üìä **Exploit Prediction**: Timeline analysis and exploit status assessment
- üõ†Ô∏è **Remediation Strategies**: Automated remediation planning and prioritization
- üîÑ **Batch Processing**: Efficient processing of multiple CVEs
- üìà **Risk Assessment**: Multi-factor risk scoring and impact analysis
- üéØ **Fallback Support**: Graceful degradation when native addon unavailable

## Installation

```bash
npm install phantom-cve-core
```

## Quick Start

```typescript
import { CVECore } from 'phantom-cve-core';

async function main() {
  // Create CVE Core instance
  const cveCore = await CVECore.new();

  // Process a CVE
  const cve = {
    id: 'CVE-2024-12345',
    description: 'Example vulnerability',
    published_date: new Date(),
    last_modified_date: new Date(),
    status: 'published',
    assigner: 'cve@mitre.org',
    tags: ['example'],
    affected_products: [{
      vendor: 'Example Corp',
      product: 'Example Product',
      version: '1.0.0'
    }],
    references: [{
      url: 'https://example.com/cve',
      source: 'Vendor',
      tags: ['vendor-advisory']
    }],
    cvss_metrics: {
      version: '3.1',
      base_score: 7.5,
      severity: 'high',
      attack_vector: 'network',
      attack_complexity: 'low',
      privileges_required: 'none',
      user_interaction: 'none',
      scope: 'unchanged',
      confidentiality_impact: 'high',
      integrity_impact: 'high',
      availability_impact: 'high'
    }
  };

  const result = await cveCore.process_cve(cve);
  console.log('Risk Level:', result.assessment.risk_level);
  console.log('Exploitability:', result.assessment.exploitability);
  console.log('Related CVEs:', result.related_cves.length);
}
```

## API Reference

### CVECore

#### `CVECore.new(): Promise<CVECore>`
Creates a new CVE Core instance.

#### `process_cve(cve: CVE): Promise<CVEAnalysisResult>`
Processes a single CVE with advanced threat intelligence analysis.

#### `batch_process_cves(cves: CVE[]): Promise<CVEAnalysisResult[]>`
Processes multiple CVEs efficiently in batch.

#### `search_cves(criteria: CVESearchCriteria): Promise<CVE[]>`
Searches for CVEs based on advanced criteria.

#### `get_exploit_timeline(cve_id: string): Promise<ExploitTimeline>`
Generates detailed exploit timeline for a CVE.

#### `get_remediation_strategy(cve: CVE): Promise<RemediationStrategy>`
Creates comprehensive remediation strategy for a CVE.

#### `get_health_status(): Promise<HealthStatus>`
Returns operational health status.

## Architecture

### Native Implementation (Production)
- **Rust Core**: High-performance vulnerability processing engine
- **N-API Bindings**: Direct native integration with Node.js
- **Advanced Algorithms**: Sophisticated threat intelligence correlation
- **Memory Safety**: Rust's memory safety guarantees

### Fallback Implementation (Development)
- **TypeScript Mock**: Full-featured mock implementation
- **Same API**: Identical interface to native version
- **Graceful Degradation**: Automatic fallback when native addon unavailable
- **Development Friendly**: Easy debugging and testing

## Building from Source

### Prerequisites
- Node.js 16+
- Rust 1.70+
- Windows: Visual Studio Build Tools (for N-API)

### Build Commands
```bash
# Install dependencies
npm install

# Build native addon (production)
npm run build

# Build debug version
npm run build:debug

# Build for all platforms
npm run universal
```

### Development Setup
```bash
# Install development dependencies
npm install -D @napi-rs/cli

# Build TypeScript
npx tsc

# Run tests
npm test
```

## Configuration

### Environment Variables
- `DEBUG`: Enable debug logging
- `NAPI_FORCE_BUILD`: Force rebuild of native addon

### Build Configuration
The `package.json` includes N-API configuration:
```json
{
  "napi": {
    "name": "phantom-cve-core",
    "triples": {
      "additional": [
        "aarch64-apple-darwin",
        "aarch64-unknown-linux-gnu",
        "aarch64-pc-windows-msvc",
        "x86_64-unknown-linux-musl"
      ]
    }
  }
}
```

## Performance

- **Native Performance**: 10-100x faster than pure JavaScript
- **Memory Efficient**: Low memory footprint with Rust's ownership system
- **Concurrent Processing**: Efficient batch processing capabilities
- **Scalable**: Handles large CVE datasets without performance degradation

## Security

- **Memory Safe**: Rust prevents common vulnerabilities
- **Input Validation**: Comprehensive input sanitization
- **Threat Intelligence**: Advanced threat actor correlation
- **Regular Updates**: Continuous security updates and patches

## Testing

```bash
# Run test suite
npm test

# Run specific test
node test.js

# Test native addon
npm run test:native
```

## Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Add tests
5. Submit a pull request

## License

MIT License - see LICENSE file for details.

## Support

- üìñ [Documentation](https://github.com/phantom-spire/phantom-cve-core)
- üêõ [Issue Tracker](https://github.com/phantom-spire/phantom-cve-core/issues)
- üí¨ [Discussions](https://github.com/phantom-spire/phantom-cve-core/discussions)

## Changelog

### v0.1.0
- Initial release with N-API implementation
- Advanced threat intelligence engine
- Comprehensive CVE processing capabilities
- Fallback TypeScript implementation
- Production-ready build system
