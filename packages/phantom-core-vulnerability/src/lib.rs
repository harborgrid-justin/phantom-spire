// Phantom Vulnerability Core - Advanced Vulnerability Assessment and Management Engine
// Enterprise-grade CVE detection, vulnerability scanning, and remediation automation

// Core engine modules (conditionally compiled for full builds)
#[cfg(not(feature = "napi"))]
mod types;
#[cfg(not(feature = "napi"))]
mod scanner;
#[cfg(not(feature = "napi"))]
mod cve_analysis;
#[cfg(not(feature = "napi"))]
mod threat_modeling;
#[cfg(not(feature = "napi"))]
mod remediation;
#[cfg(not(feature = "napi"))]
mod compliance;
#[cfg(not(feature = "napi"))]
mod reporting;
#[cfg(not(feature = "napi"))]
mod risk_assessment;
#[cfg(not(feature = "napi"))]
mod asset_discovery;
#[cfg(not(feature = "napi"))]
mod network_scanning;

// Enterprise vulnerability management modules
#[cfg(not(feature = "napi"))]
mod penetration_testing;
#[cfg(not(feature = "napi"))]
mod security_assessment;
#[cfg(not(feature = "napi"))]
mod patch_management;
#[cfg(not(feature = "napi"))]
mod configuration_assessment;
#[cfg(not(feature = "napi"))]
mod web_application_scanning;
#[cfg(not(feature = "napi"))]
mod database_security;
#[cfg(not(feature = "napi"))]
mod infrastructure_analysis;
#[cfg(not(feature = "napi"))]
mod cloud_security_assessment;
#[cfg(not(feature = "napi"))]
mod container_vulnerability_scanning;
#[cfg(not(feature = "napi"))]
mod mobile_security_testing;
#[cfg(not(feature = "napi"))]
mod iot_vulnerability_assessment;
#[cfg(not(feature = "napi"))]
mod api_security_testing;
#[cfg(not(feature = "napi"))]
mod supply_chain_analysis;
#[cfg(not(feature = "napi"))]
mod zero_day_detection;

// Advanced vulnerability intelligence modules
#[cfg(not(feature = "napi"))]
mod threat_intelligence_integration;
#[cfg(not(feature = "napi"))]
mod exploit_verification;
#[cfg(not(feature = "napi"))]
mod vulnerability_correlation;
#[cfg(not(feature = "napi"))]
mod attack_surface_analysis;
#[cfg(not(feature = "napi"))]
mod security_orchestration;
#[cfg(not(feature = "napi"))]
mod automated_remediation;
#[cfg(not(feature = "napi"))]
mod continuous_monitoring;
#[cfg(not(feature = "napi"))]
mod vulnerability_prioritization;
#[cfg(not(feature = "napi"))]
mod business_impact_analysis;
#[cfg(not(feature = "napi"))]
mod regulatory_compliance_scanning;

// NAPI wrapper for Node.js integration
mod napi_wrapper;

// Re-export NAPI wrapper for Node.js integration
#[cfg(feature = "napi")]
pub use napi_wrapper::PhantomVulnerabilityCore;

// For non-NAPI builds, provide a placeholder
#[cfg(not(feature = "napi"))]
pub struct PhantomVulnerabilityCore;

#[cfg(not(feature = "napi"))]
impl PhantomVulnerabilityCore {
    pub fn new() -> Self {
        Self
    }

    pub fn hello(&self, name: String) -> String {
        format!("Phantom Vulnerability Core says hello to {name}")
    }
}